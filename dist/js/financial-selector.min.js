var CONFIG={FINANCIAL_SERVER_URL:"http://contentfinancial2-test.appspot.com/"};angular.module("risevision.widget.common.financialSelector",[]).directive("financialSelector",["$document","$window","$log","$templateCache",function(e,n,t,i){return{restrict:"AE",scope:{instruments:"=",viewId:"@"},template:i.get("financial-selector-template.html"),link:function(n,t){e[0],$(t)}}}]),angular.module("risevision.widget.common.financialSelector").directive("instrumentList",["$document","$window","$log","$templateCache",function(e,n,t,a){return{restrict:"A",scope:{search:"="},template:a.get("instrument-list-template.html"),link:function(n,t){function a(e){for(n.instruments=[],i=0;i<e.getNumberOfRows();i++){var t={code:e.getValue(i,0),name:e.getValue(i,1)};n.instruments.push(t)}}function o(){}e[0],$(t);google.setOnLoadCallback(function(){isVisualizationLoaded=!0;var e=CONFIG.FINANCIAL_SERVER_URL+"lookup/local",t=new google.visualization.Query(e,{sendMethod:"scriptInjection"});t.setQuery("where ((lower(code) like '%"+n.search+"%') or (lower(name) like '%aa%')) order by name limit 50 offset 0"),t.send(function(e){try{if(e.isError())o(e.getMessage());else{{var n=e.getDataTable();n.getTableProperty("cursor")}a(n)}}catch(t){o(t.message)}})})}}}]),angular.module("risevision.widget.common.financialSelector").directive("instrumentSelector",["$templateCache",function(e){return{restrict:"E",scope:{instruments:"="},template:e.get("instrument-selector-template.html"),link:function(e,n){var t=$(n),i=t.find("input"),a=angular.element(i);e.add=function(){e.instruments.push(e.newInstrument),e.newInstrument=""},a.bind("keypress",function(n){13==n.keyCode&&e.$apply(e.add)}),e.dropdown=function(e){e?$(".instrument-selector.dropdown").addClass("open"):$(".instrument-selector.dropdown").removeClass("open")},e.$watch("newInstrument",function(n){e.dropdown(n)})}}}]),angular.module("risevision.widget.common.financialSelector").directive("tagManager",["$templateCache",function(e){return{restrict:"E",scope:{tags:"="},template:e.get("tag-manager-template.html"),link:function(e){e.remove=function(n){e.tags.splice(n,1)}}}}]),function(){try{app=angular.module("risevision.widget.common.financialSelector")}catch(e){app=angular.module("risevision.widget.common.financialSelector",[])}app.run(["$templateCache",function(e){"use strict";e.put("financial-selector-template.html",'<tag-manager class="tag-manager" tags="instruments"></tag-manager>\n<instrument-selector instruments="instruments"></instrument-selector>\n')}])}(),function(){try{app=angular.module("risevision.widget.common.financialSelector")}catch(e){app=angular.module("risevision.widget.common.financialSelector",[])}app.run(["$templateCache",function(e){"use strict";e.put("instrument-list-template.html",'<li class="dropdown-header">Instruments</li>\n<li class="divider"></li>\n<li ng-repeat="item in instruments">\n  <a href="#">{{item.code}}</a>{{item.name}}\n</li>\n')}])}(),function(){try{app=angular.module("risevision.widget.common.financialSelector")}catch(e){app=angular.module("risevision.widget.common.financialSelector",[])}app.run(["$templateCache",function(e){"use strict";e.put("instrument-selector-template.html",'<div class="row">\n	<div class="col-md-6">\n    <div class="instrument-selector dropdown">\n      <input class="form-control" type="text" placeholder="Add an instrument..."\n      ng-model="newInstrument" ng-blur="dropdown(false)"></input>\n      <ul instrument-list class="dropdown-menu" role="menu">\n      </ul>\n    </div>\n  </div>\n  <div class="col-md-1">\n    <a class="btn" ng-click="add()">Add</a>\n  </div>\n</div>\n')}])}(),function(){try{app=angular.module("risevision.widget.common.financialSelector")}catch(e){app=angular.module("risevision.widget.common.financialSelector",[])}app.run(["$templateCache",function(e){"use strict";e.put("tag-manager-template.html",'<div class="tags">\n  <span ng-repeat="(idx, tag) in tags" class="label label-primary">\n    {{tag}}\n    <span class="glyphicon glyphicon-remove" ng-click="remove(idx)"></span>\n  </span>\n</div>\n')}])}();